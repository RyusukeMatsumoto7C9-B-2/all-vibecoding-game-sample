# エネミー 仕様書

## 概要
地下ダンジョンに生息するモンスターで、プレイヤーを追跡・妨害する存在。レベルの進行とともに数が増え、ゲームの難易度を調整する重要な要素。

## 目的
- プレイヤーに適度な緊張感と挑戦を提供する
- レベル進行による難易度上昇システムを実現する
- 戦略的な移動を促すゲームプレイを創出する

## 機能要件
- [x] 上下左右移動システム（2025-01-22 実装完了）
- [ ] プレイヤー追跡AI
- [ ] ランダム移動AI
- [ ] レベルベース出現管理
- [ ] 画面外デス処理

## 動作仕様

### 移動システム
- **移動方向**: 上下左右の4方向のみ（斜め移動は不可）
- **移動方式**: グリッドベース移動（1マス単位）
- **移動制限**: 岩ブロック通過不可、マップ外への移動不可

### 出現システム
- **出現位置**: 画面左右の境界外
- **出現数**: レベル1で5匹、5レベル毎に+1（上限10匹）
- **デス条件**: 強制スクロールによる画面外退場

### AI動作
- **追跡モード**: プレイヤーとの距離が3マス以下で発動
- **ランダムモード**: 追跡条件外での基本行動
- **距離計算**: マンハッタン距離

## テスト仕様
テスト実装の方針とルールについては、以下のドキュメントを参照してください：
- `Documentation/Rules/TestRule.md`

## 注意事項
- AI処理は毎フレーム実行せず、適切な間隔で更新する
- エネミー同士の衝突・重複は考慮しない（同一マス占有可能）
- 追跡時の経路探索は単純な方向移動とし、複雑なパスファインディングは実装しない

## 実装詳細

### 実装済み機能
- **基本移動システム**: EnemyController、EnemyMoveService、EnemyMovementConstraint実装完了
- **移動制約**: 岩ブロック通過不可、マップ境界制限実装完了
- **共通化**: Direction.csをPlayer/Enemy間で共通化完了
- **テスト**: 単体テスト、統合テスト実装完了
- **Prefab**: Enemy.prefab作成、スプライト・コンポーネント設定完了

### 未実装機能
- **AI動作**: 追跡AI、ランダム移動AIは未実装
- **出現システム**: レベルベース出現管理は未実装
- **画面外処理**: 強制スクロールによる画面外デス処理は未実装

## 更新履歴
| 日付 | 変更内容 | 担当者 |
|------|----------|--------|
| 2025-01-12 | 初版作成 | Claude |
| 2025-01-22 | 仕様書をシンプル化、技術詳細・実装詳細を削除 | Claude |
| 2025-01-22 | 上下左右移動システム実装完了、機能要件にチェック追加 | Claude |
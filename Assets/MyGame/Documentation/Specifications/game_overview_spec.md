# ゲーム概要 仕様書

## 概要
プレイヤーが地下深くへ潜りながらお宝を収集し、エネミーを撃破してスコアを稼ぐ2D縦スクロールゲーム。
プロシージャルに生成される地下ダンジョンを探索し、可能な限り深いレベルまで到達することが目標。

## 目的
- プレイヤーに継続的な探索体験を提供する
- プロシージャル生成による無限の遊びやすさを実現する
- スコアシステムによる競争要素とリプレイ性を提供する

## 要件

### 機能要件
- 2D縦スクロールシステム（下方向への移動）
- プロシージャルマップ生成システム
- スコアシステム（深度 + お宝 + エネミー撃破）
- タイルマップベースの地形システム
- 自動スクロール機能

### 非機能要件
- 60FPSでの安定した動作
- メモリ効率的なタイルマップ管理
- スムーズなスクロール体験

## 技術仕様

### ゲームシステム
- **ゲームタイプ**: 2D縦スクロールアクションゲーム
- **スクロール方向**: 下方向（地下へ潜る）
- **画面解像度**: [要確認]
- **フレームレート**: 60FPS

### スコアシステム
- **深度スコア**: 1レベルにつき1000ポイント
- **お宝スコア**: アイテム毎に設定されたポイント（別途定義）
- **エネミー撃破スコア**: エネミー種別毎に設定されたポイント（別途定義）
- **総合スコア**: 深度スコア + お宝スコア + エネミー撃破スコア

### タイルマップシステム
- **マップサイズ**: 横20マス × 縦30マス
- **レベル定義**: 1スクロール = 1レベル
- **生成方式**: プロシージャル生成
- **地上エリア**: ゲーム開始時の上5マスは地面タイル配置なし

### スクロールシステム
- **トリガー条件**: プレイヤーの下方向残りマス数が5マス以下
- **スクロール量**: 25マス分上方向
- **スクロール対象**: タイルマップ、プレイヤー、エネミー
- **操作制限**: スクロール中はプレイヤー操作不可

## 実装詳細

### 実装手順
1. 基本タイルマップシステムの構築
2. プロシージャル生成ロジックの実装
3. スクロールシステムの実装
4. スコアシステムの実装
5. UI表示システムの実装

### 依存関係
- Unity Tilemap System
- Unity Input System
- ProBuilder（オプション）

## テスト仕様

### テスト実装方針
- t-wada流TDDを適用
- Unity TestRunnerを使用
- タイルマップ生成ロジックのユニットテスト
- スコア計算ロジックのユニットテスト
- スクロール制御ロジックのユニットテスト

### テスト項目
1. **タイルマップ生成テスト**
   - 指定サイズでのマップ生成確認
   - 地上エリアの正しい生成確認
   
2. **スクロールシステムテスト**
   - トリガー条件の正確性確認
   - スクロール量の正確性確認
   - 操作制限の動作確認

3. **スコアシステムテスト**
   - 深度スコア計算の正確性確認
   - 総合スコア計算の正確性確認

## 注意事項
- TestRunner は EditMode のみを実施する（PlayMode のテストはユーザが手動で実施する）
- 可能な限り PureC# で実装し、TestRunnerでのテストを充実させる
- メモリリークを避けるため、不要なタイルマップオブジェクトは適切に破棄する
- プロシージャル生成の乱数シードは保存・復元可能にする

## 更新履歴
| 日付 | 変更内容 | 担当者 |
|------|----------|--------|
| 2025-07-12 | 初版作成 | Claude |